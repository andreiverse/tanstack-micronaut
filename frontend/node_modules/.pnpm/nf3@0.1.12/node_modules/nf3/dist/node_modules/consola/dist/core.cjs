"use strict";const LogLevels={silent:-1/0,fatal:0,error:0,warn:1,log:2,info:3,success:3,fail:3,ready:3,start:3,box:3,debug:4,trace:5,verbose:1/0},LogTypes={silent:{level:-1},fatal:{level:LogLevels.fatal},error:{level:LogLevels.error},warn:{level:LogLevels.warn},log:{level:LogLevels.log},info:{level:LogLevels.info},success:{level:LogLevels.success},fail:{level:LogLevels.fail},ready:{level:LogLevels.info},start:{level:LogLevels.info},box:{level:LogLevels.info},debug:{level:LogLevels.debug},trace:{level:LogLevels.trace},verbose:{level:LogLevels.verbose}};function isPlainObject$1(e){if(typeof e!=`object`||!e)return!1;let o=Object.getPrototypeOf(e);return o!==null&&o!==Object.prototype&&Object.getPrototypeOf(o)!==null||Symbol.iterator in e?!1:Symbol.toStringTag in e?Object.prototype.toString.call(e)===`[object Module]`:!0}function _defu(e,o,l=`.`,u){if(!isPlainObject$1(o))return _defu(e,{},l,u);let d=Object.assign({},o);for(let o in e){if(o===`__proto__`||o===`constructor`)continue;let f=e[o];f!=null&&(u&&u(d,o,f,l)||(Array.isArray(f)&&Array.isArray(d[o])?d[o]=[...f,...d[o]]:isPlainObject$1(f)&&isPlainObject$1(d[o])?d[o]=_defu(f,d[o],(l?`${l}.`:``)+o.toString(),u):d[o]=f))}return d}function createDefu(e){return(...o)=>o.reduce((o,s)=>_defu(o,s,``,e),{})}const defu=createDefu();function isPlainObject(e){return Object.prototype.toString.call(e)===`[object Object]`}function isLogObj(e){return!(!isPlainObject(e)||!e.message&&!e.args||e.stack)}let paused=!1;const queue=[];class Consola{options;_lastLog;_mockFn;constructor(e={}){let s=e.types||LogTypes;for(let c in this.options=defu({...e,defaults:{...e.defaults},level:_normalizeLogLevel(e.level,s),reporters:[...e.reporters||[]]},{types:LogTypes,throttle:1e3,throttleMin:5,formatOptions:{date:!0,colors:!1,compact:!0}}),s){let e={type:c,...this.options.defaults,...s[c]};this[c]=this._wrapLogFn(e),this[c].raw=this._wrapLogFn(e,!0)}this.options.mockFn&&this.mockTypes(),this._lastLog={}}get level(){return this.options.level}set level(e){this.options.level=_normalizeLogLevel(e,this.options.types,this.options.level)}prompt(e,o){if(!this.options.prompt)throw Error(`prompt is not supported!`);return this.options.prompt(e,o)}create(e){let o=new Consola({...this.options,...e});return this._mockFn&&o.mockTypes(this._mockFn),o}withDefaults(e){return this.create({...this.options,defaults:{...this.options.defaults,...e}})}withTag(e){return this.withDefaults({tag:this.options.defaults.tag?this.options.defaults.tag+`:`+e:e})}addReporter(e){return this.options.reporters.push(e),this}removeReporter(e){if(e){let o=this.options.reporters.indexOf(e);if(o!==-1)return this.options.reporters.splice(o,1)}else this.options.reporters.splice(0);return this}setReporters(e){return this.options.reporters=Array.isArray(e)?e:[e],this}wrapAll(){this.wrapConsole(),this.wrapStd()}restoreAll(){this.restoreConsole(),this.restoreStd()}wrapConsole(){for(let e in this.options.types)console[`__`+e]||(console[`__`+e]=console[e]),console[e]=this[e].raw}restoreConsole(){for(let e in this.options.types)console[`__`+e]&&(console[e]=console[`__`+e],delete console[`__`+e])}wrapStd(){this._wrapStream(this.options.stdout,`log`),this._wrapStream(this.options.stderr,`log`)}_wrapStream(e,o){e&&(e.__write||=e.write,e.write=e=>{this[o].raw(String(e).trim())})}restoreStd(){this._restoreStream(this.options.stdout),this._restoreStream(this.options.stderr)}_restoreStream(e){e&&e.__write&&(e.write=e.__write,delete e.__write)}pauseLogs(){paused=!0}resumeLogs(){paused=!1;let e=queue.splice(0);for(let o of e)o[0]._logFn(o[1],o[2])}mockTypes(e){let o=e||this.options.mockFn;if(this._mockFn=o,typeof o==`function`)for(let e in this.options.types)this[e]=o(e,this.options.types[e])||this[e],this[e].raw=this[e]}_wrapLogFn(e,o){return(...s)=>{if(paused){queue.push([this,e,s,o]);return}return this._logFn(e,s,o)}}_logFn(e,o,s){if((e.level||0)>this.level)return!1;let c={date:new Date,args:[],...e,level:_normalizeLogLevel(e.level,this.options.types)};!s&&o.length===1&&isLogObj(o[0])?Object.assign(c,o[0]):c.args=[...o],c.message&&(c.args.unshift(c.message),delete c.message),c.additional&&(Array.isArray(c.additional)||(c.additional=c.additional.split(`
`)),c.args.push(`
`+c.additional.join(`
`)),delete c.additional),c.type=typeof c.type==`string`?c.type.toLowerCase():`log`,c.tag=typeof c.tag==`string`?c.tag:``;let l=(e=!1)=>{let o=(this._lastLog.count||0)-this.options.throttleMin;if(this._lastLog.object&&o>0){let e=[...this._lastLog.object.args];o>1&&e.push(`(repeated ${o} times)`),this._log({...this._lastLog.object,args:e}),this._lastLog.count=1}e&&(this._lastLog.object=c,this._log(c))};clearTimeout(this._lastLog.timeout);let u=this._lastLog.time&&c.date?c.date.getTime()-this._lastLog.time.getTime():0;if(this._lastLog.time=c.date,u<this.options.throttle)try{let e=JSON.stringify([c.type,c.tag,c.args]),o=this._lastLog.serialized===e;if(this._lastLog.serialized=e,o&&(this._lastLog.count=(this._lastLog.count||0)+1,this._lastLog.count>this.options.throttleMin)){this._lastLog.timeout=setTimeout(l,this.options.throttle);return}}catch{}l(!0)}_log(e){for(let o of this.options.reporters)o.log(e,{options:this.options})}}function _normalizeLogLevel(e,o={},s=3){return e===void 0?s:typeof e==`number`?e:o[e]&&o[e].level!==void 0?o[e].level:s}Consola.prototype.add=Consola.prototype.addReporter,Consola.prototype.remove=Consola.prototype.removeReporter,Consola.prototype.clear=Consola.prototype.removeReporter,Consola.prototype.withScope=Consola.prototype.withTag,Consola.prototype.mock=Consola.prototype.mockTypes,Consola.prototype.pause=Consola.prototype.pauseLogs,Consola.prototype.resume=Consola.prototype.resumeLogs;function createConsola(e={}){return new Consola(e)}exports.Consola=Consola,exports.LogLevels=LogLevels,exports.LogTypes=LogTypes,exports.createConsola=createConsola;