var balanced=require(`balanced-match`);module.exports=expandTop;var escSlash=`\0SLASH`+Math.random()+`\0`,escOpen=`\0OPEN`+Math.random()+`\0`,escClose=`\0CLOSE`+Math.random()+`\0`,escComma=`\0COMMA`+Math.random()+`\0`,escPeriod=`\0PERIOD`+Math.random()+`\0`;function numeric(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function escapeBraces(e){return e.split(`\\\\`).join(escSlash).split(`\\{`).join(escOpen).split(`\\}`).join(escClose).split(`\\,`).join(escComma).split(`\\.`).join(escPeriod)}function unescapeBraces(e){return e.split(escSlash).join(`\\`).split(escOpen).join(`{`).split(escClose).join(`}`).split(escComma).join(`,`).split(escPeriod).join(`.`)}function parseCommaParts(s){if(!s)return[``];var c=[],l=balanced(`{`,`}`,s);if(!l)return s.split(`,`);var u=l.pre,d=l.body,f=l.post,p=u.split(`,`);p[p.length-1]+=`{`+d+`}`;var m=parseCommaParts(f);return f.length&&(p[p.length-1]+=m.shift(),p.push.apply(p,m)),c.push.apply(c,p),c}function expandTop(e){return e?(e.substr(0,2)===`{}`&&(e=`\\{\\}`+e.substr(2)),expand(escapeBraces(e),!0).map(unescapeBraces)):[]}function embrace(e){return`{`+e+`}`}function isPadded(e){return/^-?0\d/.test(e)}function lte(e,s){return e<=s}function gte(e,s){return e>=s}function expand(s,c){var u=[],d=balanced(`{`,`}`,s);if(!d)return[s];var p=d.pre,m=d.post.length?expand(d.post,!1):[``];if(/\$$/.test(d.pre))for(var h=0;h<m.length;h++){var g=p+`{`+d.body+`}`+m[h];u.push(g)}else{var _=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(d.body),v=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(d.body),y=_||v,b=d.body.indexOf(`,`)>=0;if(!y&&!b)return d.post.match(/,(?!,).*\}/)?(s=d.pre+`{`+d.body+escClose+d.post,expand(s)):[s];var x;if(y)x=d.body.split(/\.\./);else if(x=parseCommaParts(d.body),x.length===1&&(x=expand(x[0],!1).map(embrace),x.length===1))return m.map(function(e){return d.pre+x[0]+e});var S;if(y){var C=numeric(x[0]),w=numeric(x[1]),T=Math.max(x[0].length,x[1].length),E=x.length==3?Math.abs(numeric(x[2])):1,D=lte;w<C&&(E*=-1,D=gte);var O=x.some(isPadded);S=[];for(var k=C;D(k,w);k+=E){var A;if(v)A=String.fromCharCode(k),A===`\\`&&(A=``);else if(A=String(k),O){var j=T-A.length;if(j>0){var M=Array(j+1).join(`0`);A=k<0?`-`+M+A.slice(1):M+A}}S.push(A)}}else{S=[];for(var N=0;N<x.length;N++)S.push.apply(S,expand(x[N],!1))}for(var N=0;N<S.length;N++)for(var h=0;h<m.length;h++){var g=p+S[N]+m[h];(!c||y||g)&&u.push(g)}}return u}