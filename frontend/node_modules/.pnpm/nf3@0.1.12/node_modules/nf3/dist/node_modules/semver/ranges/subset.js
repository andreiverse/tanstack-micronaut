"use strict";const Range=require(`../classes/range.js`),Comparator=require(`../classes/comparator.js`),{ANY}=Comparator,satisfies=require(`../functions/satisfies.js`),compare=require(`../functions/compare.js`),subset=(a,o,s={})=>{if(a===o)return!0;a=new Range(a,s),o=new Range(o,s);let c=!1;OUTER:for(let e of a.set){for(let a of o.set){let o=simpleSubset(e,a,s);if(c||=o!==null,o)continue OUTER}if(c)return!1}return!0},minimumVersionWithPreRelease=[new Comparator(`>=0.0.0-0`)],minimumVersion=[new Comparator(`>=0.0.0`)],simpleSubset=(e,a,l)=>{if(e===a)return!0;if(e.length===1&&e[0].semver===ANY){if(a.length===1&&a[0].semver===ANY)return!0;e=l.includePrerelease?minimumVersionWithPreRelease:minimumVersion}if(a.length===1&&a[0].semver===ANY){if(l.includePrerelease)return!0;a=minimumVersion}let u=new Set,d,f;for(let a of e)a.operator===`>`||a.operator===`>=`?d=higherGT(d,a,l):a.operator===`<`||a.operator===`<=`?f=lowerLT(f,a,l):u.add(a.semver);if(u.size>1)return null;let p;if(d&&f&&(p=compare(d.semver,f.semver,l),p>0||p===0&&(d.operator!==`>=`||f.operator!==`<=`)))return null;for(let e of u){if(d&&!satisfies(e,String(d),l)||f&&!satisfies(e,String(f),l))return null;for(let o of a)if(!satisfies(e,String(o),l))return!1;return!0}let m,h,g,_,v=f&&!l.includePrerelease&&f.semver.prerelease.length?f.semver:!1,y=d&&!l.includePrerelease&&d.semver.prerelease.length?d.semver:!1;v&&v.prerelease.length===1&&f.operator===`<`&&v.prerelease[0]===0&&(v=!1);for(let e of a){if(_=_||e.operator===`>`||e.operator===`>=`,g=g||e.operator===`<`||e.operator===`<=`,d){if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),e.operator===`>`||e.operator===`>=`){if(m=higherGT(d,e,l),m===e&&m!==d)return!1}else if(d.operator===`>=`&&!satisfies(d.semver,String(e),l))return!1}if(f){if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),e.operator===`<`||e.operator===`<=`){if(h=lowerLT(f,e,l),h===e&&h!==f)return!1}else if(f.operator===`<=`&&!satisfies(f.semver,String(e),l))return!1}if(!e.operator&&(f||d)&&p!==0)return!1}return!(d&&g&&!f&&p!==0||f&&_&&!d&&p!==0||y||v)},higherGT=(e,a,o)=>{if(!e)return a;let s=compare(e.semver,a.semver,o);return s>0?e:s<0||a.operator===`>`&&e.operator===`>=`?a:e},lowerLT=(e,a,o)=>{if(!e)return a;let s=compare(e.semver,a.semver,o);return s<0?e:s>0||a.operator===`<`&&e.operator===`<=`?a:e};module.exports=subset;